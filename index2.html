<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title -->
    <title>Gen-Z Shop - Modern E-Commerce</title>
    
    <!-- Meta Description -->
    <meta name="description" content="Welcome to Gen-Z Shop, your one-stop store for the latest trends in fashion, electronics, and more. Built for the new generation.">

    <!-- Favicon (Browser Icon) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõçÔ∏è</text></svg>">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts & Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <style>
        /* Base font */
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Active nav link style */
        .nav-link.active {
            color: #4F46E5; /* indigo-600 */
            font-weight: 600;
        }

        /* Product card hover effect */
        .product-card:hover img {
            transform: scale(1.05);
        }
        .product-card img {
            transition: transform 0.3s ease-in-out;
        }
        
        /* Custom style for Google Sign-in button */
        .google-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #D1D5DB; /* gray-300 */
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            background-color: #ffffff; /* white */
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            color: #374151; /* gray-700 */
            transition: background-color 0.2s ease;
        }
        .google-btn:hover {
            background-color: #F9FAFB; /* gray-50 */
        }
        .google-btn .material-symbols-outlined {
            font-size: 20px;
            margin-right: 12px;
            /* Cool Google colors */
            background-image: linear-gradient(to right, #4285F4, #EA4335, #FBBC05, #34A853);
            background-clip: text;
            color: transparent;
        }
        /* Custom style for Phone Sign-in button */
        .phone-btn svg {
            color: #4B5563; /* gray-600 */
        }
        .phone-btn:hover svg {
            color: #1F2937; /* gray-800 */
        }
    </style>
</head>

<body class="bg-gray-100">
    
    <!-- Notification Panel -->
    <div id="notification" class="fixed top-5 right-5 z-50 p-4 rounded-md shadow-lg" style="display: none;">
        <span id="notification-message"></span>
    </div>

    <!-- Header & Navigation -->
    <header class="bg-white shadow-md sticky top-0 z-40">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <!-- Logo -->
            <a href="#" data-nav="home" class="text-2xl font-bold text-indigo-600">
                Gen-Z Shop
            </a>

            <!-- Mobile Nav Toggle -->
            <button id="mobile-nav-toggle" class="md:hidden p-2 rounded-md text-gray-700 hover:bg-gray-100">
                <span class="material-symbols-outlined">menu</span>
            </button>

            <!-- Desktop Nav -->
            <div class="hidden md:flex items-center space-x-6">
                <a href="#" data-nav="home" class="nav-link text-gray-600 hover:text-indigo-600 transition-colors">Home</a>
                <a href="#" data-nav="products" class="nav-link text-gray-600 hover:text-indigo-600 transition-colors">Products</a>
                <a href="#" data-nav="about" class="nav-link text-gray-600 hover:text-indigo-600 transition-colors">About</a>
                <a href="#" data-nav="contact" class="nav-link text-gray-600 hover:text-indigo-600 transition-colors">Contact</a>
                
                <!-- Cart -->
                <a href="#" data-nav="cart" class="relative p-2 text-gray-600 hover:text-indigo-600 transition-colors">
                    <span class="material-symbols-outlined">shopping_cart</span>
                    <span id="cart-badge" class="absolute top-0 right-0 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center" style="display: none;">0</span>
                </a>

                <!-- Auth Links -->
                <div id="auth-links" class="flex items-center space-x-4">
                    <a href="#" data-nav="login" class="px-4 py-2 text-sm font-medium text-gray-700 hover:text-indigo-600 transition-colors">Login</a>
                    <a href="#" data-nav="register" class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition-colors">Register</a>
                </div>
                <div id="user-info" class="hidden items-center space-x-4">
                    <span id="user-email" class="text-sm font-medium text-gray-700"></span>
                    <button id="logout-btn" class="px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors">Logout</button>
                </div>
            </div>
        </nav>

        <!-- Mobile Nav Menu -->
        <div id="mobile-nav-menu" class="md:hidden bg-white shadow-lg" style="display: none;">
            <a href="#" data-nav="home" class="block nav-link px-4 py-3 text-gray-600 hover:bg-gray-100">Home</a>
            <a href="#" data-nav="products" class="block nav-link px-4 py-3 text-gray-600 hover:bg-gray-100">Products</a>
            <a href="#" data-nav="about" class="block nav-link px-4 py-3 text-gray-600 hover:bg-gray-100">About</a>
            <a href="#" data-nav="contact" class="block nav-link px-4 py-3 text-gray-600 hover:bg-gray-100">Contact</a>
            <a href="#" data-nav="cart" class="block px-4 py-3 text-gray-600 hover:bg-gray-100">Cart</a>
            
            <!-- Mobile Auth Links -->
            <div id="mobile-auth-links" class="border-t border-gray-200 px-4 py-3 space-y-3">
                <a href="#" data-nav="login" class="block w-full text-center px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors">Login</a>
                <a href="#" data-nav="register" class="block w-full text-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition-colors">Register</a>
            </div>
            <div id="mobile-user-info" class="hidden border-t border-gray-200 px-4 py-3 space-y-3">
                <span id="mobile-user-email" class="block text-sm font-medium text-gray-700 truncate"></span>
                <button id="mobile-logout-btn" class="block w-full text-center px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors">Logout</button>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main id="main-content">
        <!-- Views will be dynamically inserted here -->
        
        <!-- Home View -->
        <div id="home-view" style="display: none;">
            <!-- Hero Section -->
            <section class="bg-white">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24 text-center">
                    <h1 class="text-4xl md:text-6xl font-bold text-gray-900 mb-6">
                        Style for the <span class="text-indigo-600">Gen-Z</span>
                    </h1>
                    <p class="text-lg md:text-xl text-gray-600 mb-10 max-w-2xl mx-auto">
                        Discover the latest trends and must-have items. All in one place.
                    </p>
                    <a href="#" data-nav="products" class="bg-indigo-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all text-lg">
                        Shop Now
                    </a>
                </div>
            </section>

            <!-- Featured Products Section -->
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <h2 class="text-3xl font-bold text-center mb-10">Featured Products</h2>
                    <div id="featured-products" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                        <!-- Products will be loaded here -->
                        <div class="text-center p-4">Loading products...</div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Products View -->
        <div id="products-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <h1 class="text-4xl font-bold text-center mb-12">All Products</h1>
                    <div id="all-products-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
                        <!-- Product list will be loaded here -->
                        <div class="text-center p-4 col-span-full">Loading products...</div>
                    </div>
                </div>
            </section>
        </div>
        
        <!-- Product Detail View -->
        <div id="product-detail-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <div id="product-detail-content" class="bg-white p-8 rounded-lg shadow-md md:flex md:space-x-8">
                        <!-- Detailed product content will be loaded here -->
                        <div class="text-center p-4">Loading product details...</div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Cart View -->
        <div id="cart-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <h1 class="text-4xl font-bold text-center mb-12">Your Cart</h1>
                    <div id="cart-items" class="bg-white p-6 rounded-lg shadow-md">
                        <!-- Cart items will be loaded here -->
                    </div>
                    <div id="cart-summary" class="bg-white p-6 rounded-lg shadow-md mt-8">
                        <h2 class="text-2xl font-bold mb-4">Summary</h2>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-lg text-gray-600">Total:</span>
                            <span id="cart-total" class="text-2xl font-bold text-gray-900">$0.00</span>
                        </div>
                        <button id="checkout-btn" class="w-full bg-green-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-green-700 transition-all">
                            Proceed to Checkout
                        </button>
                    </div>
                    <div id="cart-empty" class="text-center p-8 bg-white rounded-lg shadow-md" style="display: none;">
                        <p class="text-xl text-gray-600 mb-6">Your cart is empty.</p>
                        <a href="#" data-nav="products" class="bg-indigo-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all">
                            Start Shopping
                        </a>
                    </div>
                </div>
            </section>
        </div>

        <!-- Checkout View -->
        <div id="checkout-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-2xl">
                    <h1 class="text-4xl font-bold text-center mb-12">Checkout</h1>
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h2 class="text-2xl font-bold mb-6">Order Summary</h2>
                        <div id="checkout-summary" class="space-y-4 mb-6">
                            <!-- Checkout summary items -->
                        </div>
                        <div class="flex justify-between items-center border-t pt-4">
                            <span class="text-lg font-medium text-gray-600">Total:</span>
                            <span id="checkout-total" class="text-2xl font-bold text-gray-900">$0.00</span>
                        </div>

                        <hr class="my-8">

                        <h2 class="text-2xl font-bold mb-6">Shipping Information</h2>
                        <form id="checkout-form" class="space-y-4">
                            <div>
                                <label for="checkout-name" class="block text-sm font-medium text-gray-700">Full Name</label>
                                <input type="text" id="checkout-name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <label for="checkout-email" class="block text-sm font-medium text-gray-700">Email</label>
                                <input type="email" id="checkout-email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <label for="checkout-address" class="block text-sm font-medium text-gray-700">Address</label>
                                <input type="text" id="checkout-address" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            
                            <button type="submit" class="w-full bg-indigo-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all">
                                Place Order (Demo)
                            </button>
                        </form>
                    </div>
                </div>
            </section>
        </div>

        <!-- About View -->
        <div id="about-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-3xl">
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h1 class="text-4xl font-bold text-center mb-8">About Gen-Z Shop</h1>
                        <img src="https://placehold.co/800x400/6366F1/FFFFFF?text=Gen-Z+Shop" alt="About Gen-Z Shop" class="w-full h-64 object-cover rounded-lg mb-8">
                        <div class="space-y-6 text-gray-700 leading-relaxed">
                            <p>Welcome to Gen-Z Shop, your ultimate destination for everything cool, trendy, and now. We're not just a store; we're a vibe. Born from the idea that shopping should be as dynamic and expressive as you are, we've curated a collection of products that speak your language.</p>
                            <p>From viral fashion fits and cutting-edge electronics to unique room decor that makes your space *yours*, we've got you covered. Our team scours the internet and partners with emerging brands to bring you the items that are just about to blow up.</p>
                            <p>We're more than just products; we're a community. We're powered by passion, caffeine, and a constant connection to the pulse of the internet. We believe in fast shipping, authentic products, and a seamless shopping experience.</p>
                            <p>This is shopping, evolved. This is Gen-Z Shop.</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Contact View -->
        <div id="contact-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-lg">
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h1 class="text-4xl font-bold text-center mb-8">Contact Us</h1>
                        <p class="text-center text-gray-600 mb-8">
                            Have a question or want to work together? Fill out the form below.
                        </p>
                        <form id="contact-form" class="space-y-6">
                            <div>
                                <label for="contact-name" class="block text-sm font-medium text-gray-700">Name</label>
                                <input type="text" id="contact-name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <label for="contact-email" class="block text-sm font-medium text-gray-700">Email</label>
                                <input type="email" id="contact-email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <label for="contact-message" class="block text-sm font-medium text-gray-700">Message</label>
                                <textarea id="contact-message" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required></textarea>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all">
                                Send Message
                            </button>
                        </form>
                    </div>
                </div>
            </section>
        </div>

        <!-- Login View -->
        <div id="login-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-md">
                    <div class="bg-white p-8 rounded-lg shadow-md border border-gray-200">
                        <h1 class="text-2xl font-bold text-center mb-6">Login to your Account</h1>
                        <form id="login-form" class="space-y-4">
                            <div>
                                <label for="login-email" class="block text-sm font-medium text-gray-700">Email</label>
                                <input type="email" id="login-email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <label for="login-password" class="block text-sm font-medium text-gray-700">Password</label>
                                <input type="password" id="login-password" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <button type="submit" id="login-submit-btn" class="w-full bg-indigo-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all disabled:bg-gray-400" disabled>
                                    Login
                                </button>
                            </div>
                        </form>
                        
                        <div class="relative my-6">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white text-gray-500">Or continue with</span>
                            </div>
                        </div>

                        <!-- Google Sign-in Button -->
                        <div>
                            <button id="google-signin-btn" class="google-btn disabled:bg-gray-200" disabled>
                                <span class="material-symbols-outlined">google</span>
                                Sign in with Google
                            </button>
                        </div>

                        <div class="relative my-4">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white text-gray-500">Or</span>
                            </div>
                        </div>

                        <!-- Phone Sign-in Button -->
                        <button id="phone-signin-btn-login" class="phone-btn w-full flex justify-center items-center py-3 px-4 border border-gray-300 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:bg-gray-200" disabled>
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                            Sign in with Phone
                        </button>

                        <p class="text-center text-sm text-gray-600 mt-4">
                            Don't have an account?
                            <a href="#" data-nav="register" class="font-medium text-indigo-600 hover:text-indigo-500">
                                Register here
                            </a>
                        </p>
                    </div>
                </div>
            </section>
        </div>

        <!-- Register View -->
        <div id="register-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-md">
                    <div class="bg-white p-8 rounded-lg shadow-md border border-gray-200">
                        <h1 class="text-2xl font-bold text-center mb-6">Create an Account</h1>
                        <form id="register-form" class="space-y-4">
                            <div>
                                <label for="register-email" class="block text-sm font-medium text-gray-700">Email</label>
                                <input type="email" id="register-email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <label for="register-password" class="block text-sm font-medium text-gray-700">Password</label>
                                <input type="password" id="register-password" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <label for="register-confirm-password" class="block text-sm font-medium text-gray-700">Confirm Password</label>
                                <input type="password" id="register-confirm-password" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                            </div>
                            <div>
                                <button type="submit" id="register-submit-btn" class="w-full bg-indigo-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all disabled:bg-gray-400" disabled>
                                    Create Account
                                </button>
                            </div>
                        </form>
                        
                        <div class="relative my-6">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white text-gray-500">Or sign up with</span>
                            </div>
                        </div>

                        <!-- Google Sign-in Button -->
                        <div>
                            <button id="google-signin-btn-register" class="google-btn disabled:bg-gray-200" disabled>
                                <span class="material-symbols-outlined">google</span>
                                Sign in with Google
                            </button>
                        </div>
                        
                        <div class="relative my-4">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white text-gray-500">Or</span>
                            </div>
                        </div>

                        <!-- Phone Sign-in Button -->
                        <button id="phone-signin-btn-register" class="phone-btn w-full flex justify-center items-center py-3 px-4 border border-gray-300 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:bg-gray-200" disabled>
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                            Sign in with Phone
                        </button>

                        <p class="text-center text-sm text-gray-600 mt-4">
                            Already have an account?
                            <a href="#" data-nav="login" class="font-medium text-indigo-600 hover:text-indigo-500">
                                Login here
                            </a>
                        </p>
                    </div>
                </div>
            </section>
        </div>

        <!-- Phone Login View -->
        <div id="phone-login-view" style="display: none;">
            <section class="py-16">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-md">
                    <div class="bg-white p-8 rounded-lg shadow-md border border-gray-200">
                        
                        <!-- Step 1: Enter Phone Number -->
                        <div id="phone-step-1">
                            <h1 class="text-2xl font-bold text-center mb-6">Enter Phone Number</h1>
                            <form id="phone-login-form" class="space-y-4">
                                <div>
                                    <label for="phone-number-input" class="block text-sm font-medium text-gray-700">Phone Number</label>
                                    <input type="tel" id="phone-number-input" placeholder="+855 12 345 678" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                                </div>
                                <!-- 
                                    reCAPTCHA container is no longer needed here. 
                                    We will attach the invisible reCAPTCHA to the submit button.
                                -->
                                
                                <div>
                                    <!-- This button will trigger the invisible reCAPTCHA -->
                                    <button type="submit" id="send-code-btn" class="w-full bg-indigo-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all disabled:bg-gray-400" disabled>
                                        Send Code
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Step 2: Enter Verification Code -->
                        <div id="phone-step-2" style="display: none;">
                            <h1 class="text-2xl font-bold text-center mb-6">Enter Verification Code</h1>
                            <p class="text-center text-gray-600 mb-4">A code was sent to <span id="phone-number-display" class="font-medium"></span></p>
                            <form id="verify-code-form" class="space-y-4">
                                <div>
                                    <label for="verification-code-input" class="block text-sm font-medium text-gray-700">Verification Code</label>
                                    <input type="text" id="verification-code-input" placeholder="123456" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                                </div>
                                <div>
                                    <button type="submit" id="verify-code-btn" class="w-full bg-green-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-green-700 transition-all disabled:bg-gray-400">
                                        Verify & Login
                                    </button>
                                </div>
                            </form>
                        </div>

                        <p class="text-center text-sm text-gray-600 mt-4">
                            <a href="#" data-nav="login" class="font-medium text-indigo-600 hover:text-indigo-500">
                                &larr; Back to Login
                            </a>
                        </p>
                    </div>
                </div>
            </section>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-300 mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- About -->
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">Gen-Z Shop</h4>
                    <p class="text-sm">The best products for the new generation. Style, tech, and vibes all in one place.</p>
                </div>
                <!-- Quick Links -->
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">Quick Links</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" data-nav="home" class="hover:text-white">Home</a></li>
                        <li><a href="#" data-nav="products" class="hover:text-white">Products</a></li>
                        <li><a href="#" data-nav="about" class="hover:text-white">About Us</a></li>
                        <li><a href="#" data-nav="contact" class="hover:text-white">Contact</a></li>
                    </ul>
                </div>
                <!-- Legal -->
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">Legal</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:text-white">Terms of Service</a></li>
                        <li><a href="#" class="hover:text-white">Privacy Policy</a></li>
                    </ul>
                </div>
                <!-- Contact -->
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">Contact</h4>
                    <ul class="space-y-2 text-sm">
                        <li>Email: <a href="mailto:support@genz.shop" class="hover:text-white">support@genz.shop</a></li>
                        <li>Phone: <a href="tel:+123456789" class="hover:text-white">+1 234 567 89</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-sm">
                <p>&copy; 2024 Gen-Z Shop. All rights reserved.</p>
            </div>
        </div>
    </footer>


    <!-- Firebase and App Logic -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js";
        import { 
            getAuth, 
            onAuthStateChanged, 
            signOut,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            GoogleAuthProvider,
            signInWithPopup,
            RecaptchaVerifier,
            signInWithPhoneNumber,
            signInWithCustomToken, // Added for environment
            signInAnonymously // Added for environment
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore, 
            collection, 
            getDocs, 
            doc, 
            getDoc,
            setDoc,
            addDoc,
            serverTimestamp,
            setLogLevel // <-- THE FIX IS HERE
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- GLOBAL VARIABLES ---
        
        // Use environment-provided config if available
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            // Fallback config for running locally on 127.0.0.1 or localhost
            apiKey: "AIzaSyC47kiV4yy2QwUgIfZWGo16tkz_a-a-r4g",
            authDomain: "shop-db-168.firebaseapp.com",
            projectId: "shop-db-168",
            storageBucket: "shop-db-168.firebasestorage.app",
            messagingSenderId: "506484276851",
            appId: "1:506484276851:web:5718e2a35a8d93e8b87406",
            measurementId: "G-L241ELWGBK"
        };
        
        // Get the environment-provided App ID
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        
        // Get the environment-provided initial auth token
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let app, db, auth, analytics;
        let isAuthReady = false;
        let currentUserId = null;
        let confirmationResult = null; // For phone auth
        let recaptchaVerifier = null; // For phone auth

        const state = {
            products: [],
            cart: [], // { id, name, price, image, quantity }
            currentView: 'home',
        };

        /* * We are moving initFirebase and enableAuthForms
         * from here...
         */

        // --- MOCK DATA (Fallback) ---
        const MOCK_PRODUCTS = [
            { id: '1', name: 'Cool Gen-Z Hoodie', price: 49.99, image: 'https://placehold.co/400x400/6366F1/FFFFFF?text=Hoodie', description: 'A very cool hoodie.' },
            { id: '2', name: 'Wireless Earbuds', price: 89.99, image: 'https://placehold.co/400x400/EC4899/FFFFFF?text=Earbuds', description: 'Listen to music.' },
            { id: '3', name: 'LED Strip Lights', price: 25.00, image: 'https://placehold.co/400x400/10B981/FFFFFF?text=LEDs', description: 'Light up your room.' },
            { id: '4', name: 'Skater Beanie', price: 19.99, image: 'https://placehold.co/400x400/F59E0B/FFFFFF?text=Beanie', description: 'A warm beanie.' },
        ];
        
        // --- DATABASE FUNCTIONS ---

        /**
         * Fetches products from Firestore
         */
        async function fetchProducts() {
            if (!db) {
                console.log("DB not ready, using mock data.");
                state.products = MOCK_PRODUCTS;
                renderProducts();
                return;
            }

            try {
                // Path to public product data
                const productsCollectionPath = `/artifacts/${appId}/public/data/products`;
                const productsCol = collection(db, productsCollectionPath);
                const productSnapshot = await getDocs(productsCol);
                
                const productList = productSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                if (productList.length === 0) {
                    console.log("No products found in DB, using mock data.");
                    state.products = MOCK_PRODUCTS;
                } else {
                    state.products = productList;
                    console.log("Products fetched from Firestore:", state.products);
                }
                
            } catch (error) {
                console.error("Error fetching products:", error);
                showNotification("Could not load products. Using fallback data.", "error");
                state.products = MOCK_PRODUCTS;
            }
            
            renderProducts();
        }
        
        /**
         * Fetches a single product by ID
         */
        async function fetchProductById(id) {
            // First, check local state
            let product = state.products.find(p => p.id === id);
            if (product) return product;

            // If not in state, try fetching from DB (in case it wasn't in the initial load)
            if (!db) return null;
            
            try {
                const productDocPath = `/artifacts/${appId}/public/data/products/${id}`;
                const productRef = doc(db, productDocPath);
                const productSnap = await getDoc(productRef);
                
                if (productSnap.exists()) {
                    return { id: productSnap.id, ...productSnap.data() };
                } else {
                    console.warn("No such product in DB!");
                    return null;
                }
            } catch (error) {
                console.error("Error fetching single product:", error);
                return null;
            }
        }
        
        /**
         * Places an order in Firestore
         */
        async function placeOrder(orderDetails) {
            if (!db) {
                console.error("Database not available.");
                showNotification("Error: Could not connect to order service.", "error");
                return false;
            }
            
            try {
                // Path to public order data
                const ordersCollectionPath = `/artifacts/${appId}/public/data/orders`;
                const ordersCol = collection(db, ordersCollectionPath);
                
                await addDoc(ordersCol, {
                    ...orderDetails,
                    userId: currentUserId || 'anonymous',
                    createdAt: serverTimestamp(),
                    status: 'new'
                });
                
                console.log("Order placed successfully!");
                return true;
                
            } catch (error) {
                console.error("Error placing order:", error);
                showNotification(`Order failed: ${error.message}`, "error");
                return false;
            }
        }

        // --- DOM & RENDER FUNCTIONS ---
        
        /**
         * Main DOMContentLoaded event listener
         */
        document.addEventListener('DOMContentLoaded', () => {
            /* * ...and pasting them inside here!
             */

            /**
             * Initializes Firebase and sets up auth listener
             */
            async function initFirebase() {
                try {
                    app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);
                    analytics = getAnalytics(app);
                    
                    console.log("Firebase Initialized.");
                    setLogLevel('Debug'); // This line was causing the error, now fixed by import

                    // Listen for authentication state changes
                    onAuthStateChanged(auth, async (user) => {
                        if (user) {
                            // User is signed in
                            currentUserId = user.uid;
                            isAuthReady = true; // Set auth ready *after* user is determined
                            console.log("User is signed in:", user.uid, user.email);
                            updateAuthUI(user);
                            
                            // Auto-fill checkout email if user is logged in
                            const checkoutEmail = document.getElementById('checkout-email');
                            if(checkoutEmail) checkoutEmail.value = user.email || '';
                            
                        } else {
                            // User is signed out
                            currentUserId = null;
                            isAuthReady = true; // Set auth ready *after* user is determined
                            console.log("User is signed out.");
                            updateAuthUI(null);
                        }
                        // Enable auth forms only after auth state is confirmed
                        enableAuthForms();
                    });

                    // Sign in with the provided token if available, otherwise anonymously
                    if (initialAuthToken) {
                        console.log("Signing in with custom token...");
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else if (!auth.currentUser) {
                        // This is key for localhost: if no token, sign in anonymously
                        // to at least get a user ID for DB operations
                        console.log("Signing in anonymously...");
                        await signInAnonymously(auth);
                    } else {
                        // If we're on localhost and already have a user from a previous session
                        isAuthReady = true;
                        currentUserId = auth.currentUser.uid;
                        console.log("User already signed in:", currentUserId);
                        updateAuthUI(auth.currentUser);
                        enableAuthForms();
                    }
                    
                    // Initial data fetch
                    await fetchProducts();

                } catch (error) {
                    console.error("Firebase Init Error:", error);
                    showNotification("Could not connect to services.", "error");
                    // Even if init fails, enable forms so user sees the error
                    enableAuthForms(); 
                }
            }
            
            /**
             * Enables auth form buttons once Firebase is ready
             */
            function enableAuthForms() {
                const loginBtn = document.getElementById('login-submit-btn');
                const registerBtn = document.getElementById('register-submit-btn');
                // send-code-btn is enabled by setupPhoneLogin
                const verifyCodeBtn = document.getElementById('verify-code-btn');
                const googleBtnLogin = document.getElementById('google-signin-btn');
                const phoneBtnLogin = document.getElementById('phone-signin-btn-login');
                const googleBtnRegister = document.getElementById('google-signin-btn-register');
                const phoneBtnRegister = document.getElementById('phone-signin-btn-register');

                if (loginBtn) loginBtn.disabled = false;
                if (registerBtn) registerBtn.disabled = false;
                if (verifyCodeBtn) verifyCodeBtn.disabled = false;
                if (googleBtnLogin) googleBtnLogin.disabled = false;
                if (phoneBtnLogin) phoneBtnLogin.disabled = false;
                if (googleBtnRegister) googleBtnRegister.disabled = false;
                if (phoneBtnRegister) phoneBtnRegister.disabled = false;
                
                console.log("All Auth forms enabled.");
                
                // Also enable the send code button if we are on that view
                if(state.currentView === 'phoneLogin') {
                    setupPhoneLogin(); // This will enable the send-code-btn
                }
            }


            console.log("DOM Loaded. Initializing App...");
            
            // --- GLOBAL SELECTORS ---
            const mobileNavToggle = document.getElementById('mobile-nav-toggle');
            const mobileNavMenu = document.getElementById('mobile-nav-menu');
            
            const authLinks = document.getElementById('auth-links');
            const userInfo = document.getElementById('user-info');
            const userEmail = document.getElementById('user-email');
            const logoutBtn = document.getElementById('logout-btn');

            const mobileAuthLinks = document.getElementById('mobile-auth-links');
            const mobileUserInfo = document.getElementById('mobile-user-info');
            const mobileUserEmail = document.getElementById('mobile-user-email');
            const mobileLogoutBtn = document.getElementById('mobile-logout-btn');

            const mainContent = document.getElementById('main-content');
            const googleSignInBtn = document.getElementById('google-signin-btn');
            const googleSignInBtnRegister = document.getElementById('google-signin-btn-register');

            // View containers
            const views = {
                home: document.getElementById('home-view'),
                products: document.getElementById('products-view'),
                productDetail: document.getElementById('product-detail-view'),
                cart: document.getElementById('cart-view'),
                checkout: document.getElementById('checkout-view'),
                about: document.getElementById('about-view'),
                contact: document.getElementById('contact-view'),
                login: document.getElementById('login-view'),
                register: document.getElementById('register-view'),
                phoneLogin: document.getElementById('phone-login-view'),
            };

            const cartBadge = document.getElementById('cart-badge');
            const cartItemsContainer = document.getElementById('cart-items');
            const cartSummary = document.getElementById('cart-summary');
            const cartEmpty = document.getElementById('cart-empty');
            const cartTotal = document.getElementById('cart-total');

            const contactForm = document.getElementById('contact-form');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const phoneLoginForm = document.getElementById('phone-login-form');
            const verifyCodeForm = document.getElementById('verify-code-form');

            // --- RENDER FUNCTIONS ---
            
            /**
             * Renders all products to the page
             */
            function renderProducts() {
                const featuredContainer = document.getElementById('featured-products');
                const allProductsContainer = document.getElementById('all-products-list');
                
                if (!featuredContainer || !allProductsContainer) return;
                
                featuredContainer.innerHTML = '';
                allProductsContainer.innerHTML = '';

                if (state.products.length === 0) {
                    featuredContainer.innerHTML = '<p class="text-center col-span-full">No products available.</p>';
                    allProductsContainer.innerHTML = '<p class="text-center col-span-full">No products available.</p>';
                    return;
                }

                state.products.forEach((product, index) => {
                    const productHTML = `
                        <div class="product-card bg-white rounded-lg shadow-md overflow-hidden border border-gray-200">
                            <a href="#" data-nav="productDetail" data-id="${product.id}" class="block">
                                <img src="${product.image || 'https://placehold.co/400x400'}" alt="${product.name}" class="w-full h-64 object-cover">
                            </a>
                            <div class="p-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-2 truncate">${product.name}</h3>
                                <p class="text-xl font-bold text-indigo-600 mb-4">$${product.price.toFixed(2)}</p>
                                <button data-id="${product.id}" class="add-to-cart-btn w-full bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 transition-all">
                                    Add to Cart
                                </button>
                            </div>
                        </div>
                    `;
                    // Add all to "All Products"
                    allProductsContainer.innerHTML += productHTML;
                    
                    // Add first 4 to "Featured"
                    if (index < 4) {
                        featuredContainer.innerHTML += productHTML;
                    }
                });
            }

            /**
             * Renders the product detail view
             */
            async function renderProductDetail(id) {
                const content = document.getElementById('product-detail-content');
                content.innerHTML = '<div class="text-center p-4">Loading...</div>';
                
                const product = await fetchProductById(id);
                
                if (product) {
                    content.innerHTML = `
                        <div class="md:w-1/2">
                            <img src="${product.image || 'https://placehold.co/600x600'}" alt="${product.name}" class="w-full h-auto object-cover rounded-lg shadow-md">
                        </div>
                        <div class="md:w-1/2 mt-6 md:mt-0">
                            <h1 class="text-3xl font-bold text-gray-900 mb-4">${product.name}</h1>
                            <p class="text-3xl font-bold text-indigo-600 mb-6">$${product.price.toFixed(2)}</p>
                            <p class="text-gray-700 leading-relaxed mb-8">${product.description || 'No description available.'}</p>
                            <button data-id="${product.id}" class="add-to-cart-btn w-full bg-indigo-600 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:bg-indigo-700 transition-all text-lg">
                                Add to Cart
                            </button>
                        </div>
                    `;
                } else {
                    content.innerHTML = '<div class="text-center p-4">Product not found.</div>';
                }
            }
            
            /**
             * Renders the cart
             */
            function renderCart() {
                if (state.cart.length === 0) {
                    cartItemsContainer.innerHTML = '';
                    cartSummary.style.display = 'none';
                    cartEmpty.style.display = 'block';
                } else {
                    cartItemsContainer.innerHTML = '';
                    cartSummary.style.display = 'block';
                    cartEmpty.style.display = 'none';
                    
                    let total = 0;
                    
                    state.cart.forEach(item => {
                        total += item.price * item.quantity;
                        cartItemsContainer.innerHTML += `
                            <div class="flex items-center justify-between py-4 border-b">
                                <div class="flex items-center space-x-4">
                                    <img src="${item.image || 'https://placehold.co/100x100'}" alt="${item.name}" class="w-16 h-16 object-cover rounded-md">
                                    <div>
                                        <h4 class="text-lg font-semibold text-gray-900">${item.name}</h4>
                                        <p class="text-gray-600">$${item.price.toFixed(2)}</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <button data-id="${item.id}" data-change="-1" class="quantity-change-btn p-1 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300">
                                        <span class="material-symbols-outlined text-sm">remove</span>
                                    </button>
                                    <span class="font-medium">${item.quantity}</span>
                                    <button data-id="${item.id}" data-change="1" class="quantity-change-btn p-1 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300">
                                        <span class="material-symbols-outlined text-sm">add</span>
                                    </button>
                                </div>
                            </div>
                        `;
                    });
                    
                    cartTotal.textContent = `$${total.toFixed(2)}`;
                }
            }

            /**
             * Renders the checkout summary
             */
            function renderCheckout() {
                const summaryContainer = document.getElementById('checkout-summary');
                const totalEl = document.getElementById('checkout-total');
                
                if (state.cart.length === 0) {
                    summaryContainer.innerHTML = '<p>Your cart is empty.</p>';
                    totalEl.textContent = '$0.00';
                    return;
                }
                
                summaryContainer.innerHTML = '';
                let total = 0;
                
                state.cart.forEach(item => {
                    total += item.price * item.quantity;
                    summaryContainer.innerHTML += `
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold">${item.name}</h4>
                                <p class="text-sm text-gray-600">Quantity: ${item.quantity}</p>
                            </div>
                            <span class="font-medium">$${(item.price * item.quantity).toFixed(2)}</span>
                        </div>
                    `;
                });
                
                totalEl.textContent = `$${total.toFixed(2)}`;
                
                // Prefill email if user is logged in
                const checkoutEmailEl = document.getElementById('checkout-email');
                if (auth.currentUser && auth.currentUser.email) {
                    checkoutEmailEl.value = auth.currentUser.email;
                }
            }
            
            /**
             * Shows the correct view and hides others
             */
            function showView(viewName, data = null) {
                // Hide all views
                for (const key in views) {
                    if (views[key]) {
                        views[key].style.display = 'none';
                    }
                }
                
                // Show the requested view
                if (views[viewName]) {
                    views[viewName].style.display = 'block';
                    state.currentView = viewName;
                    
                    // Update active nav link
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('data-nav') === viewName) {
                            link.classList.add('active');
                        }
                    });
                    
                    // Close mobile nav menu
                    if (mobileNavMenu.style.display === 'block') {
                        mobileNavMenu.style.display = 'none';
                    }
                    
                    // Scroll to top
                    window.scrollTo(0, 0);

                } else {
                    console.error(`View "${viewName}" not found.`);
                    views.home.style.display = 'block'; // Fallback to home
                }
                
                // Handle dynamic content loading
                if (viewName === 'productDetail' && data && data.id) {
                    renderProductDetail(data.id);
                }
                if (viewName === 'cart') {
                    renderCart();
                }
                if (viewName === 'checkout') {
                    renderCheckout();
                }
                if (viewName === 'phoneLogin') {
                    // Setup reCAPTCHA when the view is shown
                    setupPhoneLogin();
                }
            }

            /**
             * Updates the auth-related UI elements
             */
            function updateAuthUI(user) {
                if (user && !user.isAnonymous) { // Only show user info if not anonymous
                    // User is signed in
                    authLinks.style.display = 'none';
                    userInfo.style.display = 'flex';
                    userEmail.textContent = user.email || 'Logged In';
                    
                    mobileAuthLinks.style.display = 'none';
                    mobileUserInfo.style.display = 'block';
                    mobileUserEmail.textContent = user.email || 'Logged In';
                } else {
                    // User is signed out or anonymous
                    authLinks.style.display = 'flex';
                    userInfo.style.display = 'none';
                    userEmail.textContent = '';

                    mobileAuthLinks.style.display = 'block';
                    mobileUserInfo.style.display = 'none';
                    mobileUserEmail.textContent = '';
                }
            }
            

            // --- AUTHENTICATION LOGIC ---

            /**
             * Sets up the invisible reCAPTCHA verifier for phone auth
             */
            function setupPhoneLogin() {
                const sendCodeBtn = document.getElementById('send-code-btn');
                if (!sendCodeBtn) return;
                
                // Don't re-initialize if it already exists and is rendered
                if (recaptchaVerifier) return;

                console.log("Setting up invisible reCAPTCHA...");
                try {
                    // Attach the invisible reCAPTCHA to the "Send Code" button
                    recaptchaVerifier = new RecaptchaVerifier(auth, 'send-code-btn', {
                        'size': 'invisible',
                        'callback': (response) => {
                            // This callback is usually triggered after signInWithPhoneNumber
                            console.log("reCAPTCHA verified (invisible)");
                        },
                        'expired-callback': () => {
                            console.log("reCAPTCHA expired (invisible)");
                            showNotification("reCAPTCHA expired. Please try again.", "error");
                        }
                    });
                    
                    // Enable the send-code-btn specifically here
                    if(isAuthReady) {
                        sendCodeBtn.disabled = false;
                    }
                    console.log("Invisible reCAPTCHA setup complete.");
                } catch (error) {
                    console.error("reCAPTCHA setup error:", error);
                    showNotification("Could not initialize reCAPTCHA. Please refresh.", "error");
                }
            }

            /**
             * Handles sending the phone verification code
             */
            async function handleSendCode(e) {
                e.preventDefault();
                if (!auth || !isAuthReady) {
                    showNotification("Auth service not ready. Please refresh.", "error");
                    return;
                }
                // Ensure verifier is ready
                if (!recaptchaVerifier) {
                    setupPhoneLogin(); // Try to set it up again
                    if(!recaptchaVerifier) {
                        showNotification("reCAPTCHA not ready. Please wait a moment.", "error");
                        return;
                    }
                }

                const phoneNumberInput = document.getElementById('phone-number-input');
                const phoneNumber = phoneNumberInput.value;
                
                // Simple validation for E.164 format
                if (!/^\+[1-9]\d{1,14}$/.test(phoneNumber)) {
                    showNotification("Please enter a valid phone number in E.164 format (e.g., +85512345678).", "error");
                    return;
                }

                const sendCodeBtn = document.getElementById('send-code-btn');
                sendCodeBtn.disabled = true;
                sendCodeBtn.textContent = "Sending...";

                const appVerifier = recaptchaVerifier; // Use the invisible verifier

                try {
                    // signInWithPhoneNumber will automatically trigger the invisible reCAPTCHA
                    confirmationResult = await signInWithPhoneNumber(auth, phoneNumber, appVerifier);
                    
                    console.log("Code sent, confirmationResult:", confirmationResult);
                    showNotification("Verification code sent to your phone.", "success");
                    
                    // Show step 2, hide step 1
                    document.getElementById('phone-step-1').style.display = 'none';
                    document.getElementById('phone-step-2').style.display = 'block';
                    document.getElementById('phone-number-display').textContent = phoneNumber;
                    document.getElementById('verify-code-btn').disabled = false;
                
                } catch (error) {
                    console.error("Error sending phone code:", error);
                    showNotification(`Error: ${error.message}`, "error");
                    // Reset invisible reCAPTCHA (by clearing the verifier)
                    if (recaptchaVerifier) {
                        recaptchaVerifier.clear();
                        recaptchaVerifier = null; // Force re-setup on next view
                    }
                } finally {
                    sendCodeBtn.disabled = false;
                    sendCodeBtn.textContent = "Send Code";
                }
            }

            /**
             * Handles verifying the SMS code
             */
            async function handleVerifyCode(e) {
                e.preventDefault();
                if (!confirmationResult) {
                    showNotification("No confirmation result. Please send code again.", "error");
                    return;
                }

                const codeInput = document.getElementById('verification-code-input');
                const code = codeInput.value;

                if (code.length < 6) {
                    showNotification("Please enter a valid 6-digit code.", "error");
                    return;
                }

                const verifyBtn = document.getElementById('verify-code-btn');
                verifyBtn.disabled = true;
                verifyBtn.textContent = "Verifying...";

                try {
                    await confirmationResult.confirm(code);
                    
                    showNotification("Phone number verified! Logged in successfully.", "success");
                    
                    // Reset forms
                    if(phoneLoginForm) phoneLoginForm.reset();
                    if(verifyCodeForm) verifyCodeForm.reset();
                    
                    // Reset views
                    document.getElementById('phone-step-1').style.display = 'block';
                    document.getElementById('phone-step-2').style.display = 'none';
                    
                    // Reset reCAPTCHA
                    if (recaptchaVerifier) {
                        recaptchaVerifier.clear();
                        recaptchaVerifier = null;
                    }
                    
                    showView('home');
                    // onAuthStateChanged will update the UI
                    
                } catch (error) {
                    console.error("Error verifying code:", error);
                    showNotification(`Invalid code: ${error.message}`, "error");
                } finally {
                    verifyBtn.disabled = false;
                    verifyBtn.textContent = "Verify & Login";
                }
            }


            /**
             * Handles new user registration
             */
            async function handleRegister(e) {
                e.preventDefault();
                if (!isAuthReady || !auth) {
                    showNotification("Auth service not ready.", "error");
                    return;
                }
                
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const confirmPassword = document.getElementById('register-confirm-password').value;
                
                if (password !== confirmPassword) {
                    showNotification("Passwords do not match.", "error");
                    return;
                }
                
                try {
                    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                    console.log("User registered:", userCredential.user);
                    showNotification("Account created successfully!", "success");
                    registerForm.reset();
                    showView('home'); // Go to home after register
                } catch (error) {
                    console.error("Register Error:", error);
                    showNotification(error.message, "error");
                }
            }

            /**
             * Handles user login
             */
            async function handleLogin(e) {
                e.preventDefault();
                if (!isAuthReady || !auth) {
                    showNotification("Auth service not ready.", "error");
                    return;
                }
                
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                
                try {
                    const userCredential = await signInWithEmailAndPassword(auth, email, password);
                    console.log("User logged in:", userCredential.user);
                    showNotification("Logged in successfully!", "success");
                    loginForm.reset();
                    showView('home'); // Go to home after login
                } catch (error) {
                    console.error("Login Error:", error);
                    showNotification(error.message, "error");
                }
            }
            
            /**
             * Handles Google Sign-in
             */
            async function handleGoogleSignIn() {
                if (!isAuthReady || !auth) {
                    showNotification("Auth service not ready.", "error");
                    return;
                }
                
                const provider = new GoogleAuthProvider();
                
                try {
                    const result = await signInWithPopup(auth, provider);
                    console.log("Google Sign-in success:", result.user);
                    showNotification("Logged in with Google successfully!", "success");
                    showView('home');
                } catch (error) {
                    console.error("Google Sign-in Error:", error);
                    // Handle common errors
                    if (error.code === 'auth/popup-blocked') {
                        showNotification("Popup blocked by browser. Please allow popups for this site.", "error");
                    } else {
                        showNotification(error.message, "error");
                    }
                }
            }

            /**
             * Handles user logout
             */
            async function handleLogout() {
                if (!auth) return;
                try {
                    await signOut(auth);
                    console.log("User logged out.");
                    showNotification("Logged out successfully.", "success");
                    state.cart = []; // Clear cart on logout
                    updateCartBadge();
                    showView('home'); // Go to home after logout
                    
                    // After logging out, sign in anonymously again for localhost/env
                    if (initialAuthToken) {
                        console.log("Re-signing in with custom token...");
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else if (!auth.currentUser) {
                        console.log("Re-signing in anonymously...");
                        await signInAnonymously(auth);
                    }
                    
                } catch (error) {
                    console.error("Logout Error:", error);
                    showNotification(error.message, "error");
                }
            }
            
            // --- CART LOGIC ---
            
            /**
             * Adds a product to the cart
             */
            function addToCart(id) {
                const product = state.products.find(p => p.id === id);
                if (!product) return;
                
                const cartItem = state.cart.find(item => item.id === id);
                
                if (cartItem) {
                    cartItem.quantity++;
                } else {
                    state.cart.push({
                        id: product.id,
                        name: product.name,
                        price: product.price,
                        image: product.image,
                        quantity: 1
                    });
                }
                
                showNotification(`${product.name} added to cart!`, "success");
                updateCartBadge();
            }

            /**
             * Updates the quantity of a cart item
             */
            function updateCartQuantity(id, change) {
                const cartItem = state.cart.find(item => item.id === id);
                
                if (cartItem) {
                    cartItem.quantity += change;
                    
                    if (cartItem.quantity <= 0) {
                        // Remove item
                        state.cart = state.cart.filter(item => item.id !== id);
                    }
                }
                
                updateCartBadge();
                
                // Re-render if in cart view
                if (state.currentView === 'cart') {
                    renderCart();
                }
            }

            /**
             * Updates the cart badge count
             */
            function updateCartBadge() {
                const totalItems = state.cart.reduce((total, item) => total + item.quantity, 0);
                
                if (totalItems > 0) {
                    cartBadge.textContent = totalItems;
                    cartBadge.style.display = 'flex';
                } else {
                    cartBadge.style.display = 'none';
                }
            }

            // --- MISC & EVENT HANDLERS ---
            
            /**
             * Shows a notification message
             */
            function showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                const notificationMessage = document.getElementById('notification-message');
                
                notificationMessage.textContent = message;
                
                if (type === 'error') {
                    notification.className = 'fixed top-5 right-5 z-50 p-4 rounded-md shadow-lg bg-red-500 text-white';
                } else {
                    notification.className = 'fixed top-5 right-5 z-50 p-4 rounded-md shadow-lg bg-green-500 text-white';
                }
                
                notification.style.display = 'block';
                
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }
            
            /**
             * Handles contact form submission
             */
            function handleContactSubmit(e) {
                e.preventDefault();
                
                // --- ·ûÄ·ûº·ûä Telegram ·ûê·üí·ûò·û∏ (New Telegram code) ---
                // !!! ·ûÄ·û∂·ûö·ûñ·üí·ûö·ûò·û∂·ûì: ·ûÄ·û∂·ûö·ûä·û∂·ûÄ·üã Token ·ûë·û∏·ûì·üÅ·üá·ûò·û∑·ûì·ûò·û∂·ûì·ûü·ûª·ûú·ûè·üí·ûê·û∑·ûó·û∂·ûñ·ûë·üÅ! (Warning: Putting Token here is insecure!)
                const botToken = '7249472136:AAHtXRB7YSMaWi0MxiDRjzbYmnImdgCh_FA'; 
                const chatId = '1458220999'; 
                const form = document.getElementById('contact-form');

                // ·ûî·üí·ûö·ûæ ID ·ûè·üí·ûö·ûπ·ûò·ûè·üí·ûö·ûº·ûú (Use correct IDs)
                const name = document.getElementById('contact-name').value.trim();
                const email = document.getElementById('contact-email').value.trim();
                const message = document.getElementById('contact-message').value.trim();

                if(name === "" || email === "" || message === "") {
                    // ·ûî·üí·ûö·ûæ showNotification ·ûá·üÜ·ûì·ûΩ·ûü alert (Use showNotification instead of alert)
                    showNotification("·ûü·ûº·ûò·ûî·ûâ·üí·ûÖ·ûº·ûõ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûÇ·üí·ûö·ûî·üã·ûú·û∂·ûõ!", "error");
                    return;
                }

                const text = `üì© ·ûü·û∂·ûö·ûê·üí·ûò·û∏·ûñ·û∏ Website:\n\nüë§ ·ûà·üí·ûò·üÑ·üá: ${name}\nüìß ·û¢·üä·û∏·ûò·üÇ·ûõ: ${email}\nüí¨ ·ûü·û∂·ûö: ${message}`;

                fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: text
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if(data.ok){
                        showNotification("‚úÖ ·ûü·û∂·ûö·ûö·ûî·ûü·üã·û¢·üí·ûì·ûÄ·ûî·û∂·ûì·ûï·üí·ûâ·ûæ·ûö·ûΩ·ûÖ·ûö·û∂·ûõ·üã!", "success");
                        if(form) form.reset();
                    } else {
                        console.error("Telegram error:", data);
                        showNotification("‚ùå ·ûò·û∂·ûì·ûî·ûâ·üí·û†·û∂·ûÄ·üí·ûì·ûª·ûÑ·ûÄ·û∂·ûö·ûï·üí·ûâ·ûæ·ûü·û∂·ûö.", "error");
                    }
                })
                .catch(error => {
                    console.error("Fetch Error:", error);
                    showNotification("‚ùå ·ûò·û∂·ûì·ûÄ·üÜ·û†·ûª·ûü: " + error.message, "error");
                });
            }

            /**
             * Handles checkout form submission
             */
            async function handleCheckoutSubmit(e) {
                e.preventDefault();
                
                const orderDetails = {
                    name: document.getElementById('checkout-name').value,
                    email: document.getElementById('checkout-email').value,
                    address: document.getElementById('checkout-address').value,
                    items: state.cart,
                    total: state.cart.reduce((total, item) => total + (item.price * item.quantity), 0)
                };
                
                // Try to place the order
                const success = await placeOrder(orderDetails);
                
                if (success) {
                    showNotification("Order placed successfully! (Demo)", "success");
                    state.cart = []; // Clear cart
                    updateCartBadge();
                    document.getElementById('checkout-form').reset();
                    showView('home');
                } else {
                    showNotification("There was an error placing your order. Please try again.", "error");
                }
            }

            // --- INITIAL EVENT LISTENERS ---

            // Mobile Nav Toggle
            mobileNavToggle.addEventListener('click', () => {
                const isHidden = mobileNavMenu.style.display === 'none';
                mobileNavMenu.style.display = isHidden ? 'block' : 'none';
            });

            // Global click listener for navigation and actions
            document.body.addEventListener('click', (e) => {
                const target = e.target;
                
                // --- Navigation ---
                const navLink = target.closest('[data-nav]');
                if (navLink) {
                    e.preventDefault();
                    const view = navLink.getAttribute('data-nav');
                    const id = navLink.getAttribute('data-id');
                    showView(view, { id });
                }
                
                // --- Logout ---
                const logout = target.closest('#logout-btn') || target.closest('#mobile-logout-btn');
                if (logout) {
                    e.preventDefault();
                    handleLogout();
                }

                // --- Add to Cart ---
                const addToCartBtn = target.closest('.add-to-cart-btn');
                if (addToCartBtn) {
                    e.preventDefault();
                    const id = addToCartBtn.getAttribute('data-id');
                    addToCart(id);
                }
                
                // --- Update Cart Quantity ---
                const quantityBtn = target.closest('.quantity-change-btn');
                if (quantityBtn) {
                    e.preventDefault();
                    const id = quantityBtn.getAttribute('data-id');
                    const change = parseInt(quantityBtn.getAttribute('data-change'), 10);
                    updateCartQuantity(id, change);
                }
                
                // --- Go to Checkout ---
                const checkoutBtn = target.closest('#checkout-btn');
                if (checkoutBtn) {
                    e.preventDefault();
                    showView('checkout');
                }

                // --- Phone Sign-in Link ---
                const phoneLink = target.closest('#phone-signin-btn-login') || target.closest('#phone-signin-btn-register');
                if (phoneLink) {
                    e.preventDefault();
                    showView('phoneLogin');
                }
            });

            // --- Form Submissions ---
            
            // Contact Form Submit
            if(contactForm) {
                contactForm.addEventListener('submit', handleContactSubmit);
            }
            
            // Checkout Form Submit
            const checkoutForm = document.getElementById('checkout-form');
            if(checkoutForm) {
                checkoutForm.addEventListener('submit', handleCheckoutSubmit);
            }

            // Login Form Submit
            if(loginForm) {
                loginForm.addEventListener('submit', handleLogin);
            }

            // Register Form Submit
            if(registerForm) {
                registerForm.addEventListener('submit', handleRegister);
            }

            // Phone Form Submissions
            if (phoneLoginForm) {
                phoneLoginForm.addEventListener('submit', handleSendCode);
            }
            if (verifyCodeForm) {
                verifyCodeForm.addEventListener('submit', handleVerifyCode);
            }

            // Google Sign-in Buttons
            if (googleSignInBtn) {
                googleSignInBtn.addEventListener('click', handleGoogleSignIn);
            }
            if (googleSignInBtnRegister) {
                googleSignInBtnRegister.addEventListener('click', handleGoogleSignIn);
            }

            // --- APP START ---
            initFirebase();
            showView('home'); // Show home view by default
        });

    </script>

    <script>
        // ·ûì·û∂·üÜ·ûÖ·ûº·ûõ (Import) Firebase Admin ·ûì·û∑·ûÑ Cloud Functions
const functions = require('firebase-functions');
const admin = require('firebase-admin');
const fetch = require('node-fetch'); // ·ûè·üí·ûö·ûº·ûú·ûÄ·û∂·ûö fetch ·ûü·ûò·üí·ûö·û∂·ûî·üã·ûÜ·üí·ûõ·ûæ·ûô·ûè·ûî·ûë·üÖ Telegram

admin.initializeApp();
const db = admin.firestore();

// --- ·ûè·üí·ûö·ûº·ûú·ûî·üÜ·ûñ·üÅ·ûâ (MUST FILL IN) ---
// ·ûá·üÜ·ûì·ûΩ·ûü 'YOUR_BOT_TOKEN_HERE' ·ûá·û∂·ûò·ûΩ·ûô Bot Token ·ûê·üí·ûò·û∏·ûö·ûî·ûü·üã·û¢·üí·ûì·ûÄ
const BOT_TOKEN = '8476586909:AAGxags-UgAFWstfIKGEGQM5sk05Oab2_28'; 

// ·ûá·üÜ·ûì·ûΩ·ûü 'YOUR_ADMIN_CHAT_ID_HERE' ·ûá·û∂·ûò·ûΩ·ûô Chat ID ·ûö·ûî·ûü·üã·û¢·üí·ûì·ûÄ (Admin)
// ·ûì·üÅ·üá·ûá·û∂ Chat ID ·ûñ·û∏·ûò·ûª·ûì·ûö·ûî·ûü·üã·û¢·üí·ûì·ûÄ: '1458220999'
const ADMIN_CHAT_ID = '1458220999'; 

// ·ûá·üÜ·ûì·ûΩ·ûü 'default-app-id' ·ûá·û∂·ûò·ûΩ·ûô App ID ·ûñ·û∑·ûè·ûî·üí·ûö·û∂·ûÄ·ûä·ûö·ûî·ûü·üã·û¢·üí·ûì·ûÄ
// ·ûì·üÖ·ûÄ·üí·ûì·ûª·ûÑ index.html ·û¢·üí·ûì·ûÄ·ûî·üí·ûö·ûæ __app_id, ·û¢·üí·ûì·ûÄ·ûè·üí·ûö·ûº·ûú·ûö·ûÄ·ûè·ûò·üí·ûõ·üÉ·ûñ·û∑·ûè·ûö·ûî·ûü·üã·ûú·û∂
const APP_ID = 'default-app-id'; 
// --- ·ûî·ûâ·üí·ûÖ·ûî·üã·ûÄ·û∂·ûö·ûî·üÜ·ûñ·üÅ·ûâ ---


/**
 * ·ûï·üí·ûâ·ûæ·ûü·û∂·ûö·ûÜ·üí·ûõ·ûæ·ûô·ûè·ûî·ûë·üÖ·ûÄ·û∂·ûì·üã Telegram
 */
async function sendTelegramResponse(chatId, text) {
  const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
  const payload = {
    chat_id: chatId,
    text: text,
  };

  try {
    await fetch(url, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });
  } catch (error) {
    console.error("Error sending Telegram response:", error);
  }
}

/**
 * ·ûò·ûª·ûÅ·ûÑ·û∂·ûö (Function) ·ûì·üÅ·üá ·ûì·ûπ·ûÑ·ûä·üÜ·ûé·ûæ·ûö·ûÄ·û∂·ûö·ûö·û∂·ûõ·üã·ûñ·üÅ·ûõ·ûä·üÇ·ûõ Telegram ·ûï·üí·ûâ·ûæ·ûü·û∂·ûö·ûò·ûÄ
 * ·û¢·üí·ûì·ûÄ·ûè·üí·ûö·ûº·ûú·ûè‡∫±‡ªâ‡∫á Webhook ·ûö·ûî·ûü·üã Telegram Bot ·û±·üí·ûô·ûÖ·ûÑ·üí·û¢·ûª·ûõ·ûò·ûÄ URL ·ûö·ûî·ûü·üã Function ·ûì·üÅ·üá
 */
exports.telegramWebhook = functions.https.onRequest(async (req, res) => {
  // ·ûñ·û∑·ûì·û∑·ûè·üí·ûô·ûò·ûæ·ûõ·ûê·û∂·ûü·û∂·ûö·ûò·ûÄ·ûñ·û∏ Telegram ·ûò·üÇ·ûì
  if (req.method !== 'POST') {
    return res.status(405).send('Method Not Allowed');
  }

  const update = req.body;
  
  // ·ûñ·û∑·ûì·û∑·ûè·üí·ûô·ûò·ûæ·ûõ·ûê·û∂·ûè·ûæ·ûú·û∂·ûá·û∂·ûü·û∂·ûö (message) ·û†·ûæ·ûô·ûò·û∂·ûì·û¢·ûÄ·üí·ûü·ûö (text) ·û¨·û¢·ûè·üã
  if (!update.message || !update.message.text) {
    return res.status(200).send('OK'); // ·ûò·û∑·ûì·ûò·üÇ·ûì·ûá·û∂·ûü·û∂·ûö·ûä·üÇ·ûõ·ûô·ûæ·ûÑ·ûÖ·ûÑ·üã·ûî·û∂·ûì
  }

  const message = update.message;
  const chatId = message.chat.id.toString(); // ·ûî·ûò·üí·ûõ·üÇ·ûÑ·ûë·üÖ·ûá·û∂ String
  const text = message.text;

  // --- ·ûï·üí·ûì·üÇ·ûÄ·ûü·ûª·ûú·ûè·üí·ûê·û∑·ûó·û∂·ûñ (Security Check) ---
  // ·ûñ·û∑·ûì·û∑·ûè·üí·ûô·ûò·ûæ·ûõ·ûê·û∂ ·ûè·ûæ·û¢·üí·ûì·ûÄ·ûï·üí·ûâ·ûæ·ûá·û∂ Admin ·û¨·û¢·ûè·üã?
  if (chatId !== ADMIN_CHAT_ID) {
    await sendTelegramResponse(chatId, 'Sorry, you are not authorized to add products.');
    return res.status(200).send('OK');
  }

  // --- ·ûï·üí·ûì·üÇ·ûÄ·ûä·üÜ·ûé·ûæ·ûö·ûÄ·û∂·ûö (Processing Logic) ---
  
  // ·ûñ·û∑·ûì·û∑·ûè·üí·ûô·ûò·ûæ·ûõ·ûñ·û∂·ûÄ·üí·ûô·ûî·ûâ·üí·ûá·û∂ (command)
  if (text.startsWith('/additem ')) {
    // ·ûß·ûë·û∂·û†·ûö·ûé·üç command: /additem Hoodie, 49.99, https://image.url/hoodie.png, This is a cool hoodie.
    // ·ûô·ûæ·ûÑ·ûî·üÜ·ûî·üÇ·ûÄ (parse) command ·ûì·üÑ·üá
    const parts = text.substring(9).split(',').map(s => s.trim()); // ·ûî·üÜ·ûî·üÇ·ûÄ·ûä·üÑ·ûô·ûü·ûâ·üí·ûâ·û∂ ,

    if (parts.length < 4) {
      await sendTelegramResponse(chatId, 'Error: Format ·ûò·û∑·ûì·ûè·üí·ûö·ûπ·ûò·ûè·üí·ûö·ûº·ûú.\n·ûü·ûº·ûò·ûî·üí·ûö·ûæ: /additem <Name>, <Price>, <Image URL>, <Description>');
      return res.status(200).send('OK');
    }

    const [name, priceStr, image, description] = parts;
    const price = parseFloat(priceStr); // ·ûî·ûò·üí·ûõ·üÇ·ûÑ·ûè·ûò·üí·ûõ·üÉ·ûë·üÖ·ûá·û∂·ûõ·üÅ·ûÅ

    if (isNaN(price)) {
      await sendTelegramResponse(chatId, `Error: ·ûè·ûò·üí·ûõ·üÉ "${priceStr}" ·ûò·û∑·ûì·ûè·üí·ûö·ûπ·ûò·ûè·üí·ûö·ûº·ûú. ·ûü·ûº·ûò·ûî·ûâ·üí·ûÖ·ûº·ûõ·ûè·üÇ·ûõ·üÅ·ûÅ.`);
      return res.status(200).send('OK');
    }

    // ·ûè·üí·ûö·üÄ·ûò·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô (Prepare data) ·ûü·ûò·üí·ûö·û∂·ûî·üã Firestore
    const newProduct = {
      name: name,
      price: price,
      image: image,
      description: description,
      createdAt: admin.firestore.FieldValue.serverTimestamp() // ·ûî·ûì·üí·ûê·üÇ·ûò·ûñ·üÅ·ûõ·ûú·üÅ·ûõ·û∂
    };

    try {
      // ·ûü·üí·ûú·üÇ·ûÑ·ûö·ûÄ Collection ·ûï·ûõ·û∑·ûè·ûï·ûõ (Find the products collection)
      const productsCollectionPath = `/artifacts/${APP_ID}/public/data/products`;
      const productsCol = db.collection(productsCollectionPath);
      
      // ·ûî·ûì·üí·ûê·üÇ·ûò·ûï·ûõ·û∑·ûè·ûï·ûõ·ûê·üí·ûò·û∏ (Add new product)
      await productsCol.add(newProduct);

      // ·ûï·üí·ûâ·ûæ·ûü·û∂·ûö·ûî·üí·ûö·û∂·ûî·üã Admin ·ûê·û∂·ûá·üÑ·ûÇ·ûá·üê·ûô
      await sendTelegramResponse(chatId, `‚úÖ ·ûá·üÑ·ûÇ·ûá·üê·ûô! ·ûï·ûõ·û∑·ûè·ûï·ûõ "${name}" ·ûè·üí·ûö·ûº·ûú·ûî·û∂·ûì·ûî·ûì·üí·ûê·üÇ·ûò·ûë·üÖ·ûÄ·üí·ûì·ûª·ûÑ Website ·û†·ûæ·ûô·üî`);
      
    } catch (error) {
      console.error("Error adding product to Firestore:", error);
      await sendTelegramResponse(chatId, `‚ùå ·ûò·û∂·ûì·ûî·ûâ·üí·û†·û∂! ·ûò·û∑·ûì·û¢·û∂·ûÖ·ûî·ûì·üí·ûê·üÇ·ûò·ûï·ûõ·û∑·ûè·ûï·ûõ·ûî·û∂·ûì: ${error.message}`);
    }

  } else {
    // ·ûî·üí·ûö·ûü·û∑·ûì·ûî·ûæ command ·ûò·û∑·ûì·ûü·üí·ûÇ·û∂·ûõ·üã
    await sendTelegramResponse(chatId, 'Command ·ûò·û∑·ûì·ûü·üí·ûÇ·û∂·ûõ·üã.\n·ûä·ûæ·ûò·üí·ûî·û∏·ûî·ûì·üí·ûê·üÇ·ûò·ûï·ûõ·û∑·ûè·ûï·ûõ ·ûü·ûº·ûò·ûî·üí·ûö·ûæ: /additem <Name>, <Price>, <Image URL>, <Description>');
  }

  // ·ûÜ·üí·ûõ·ûæ·ûô·ûè·ûî OK ·ûë·üÖ Telegram ·ûú·û∑·ûâ
  return res.status(200).send('OK');
});
    </script>
</body>
</html>